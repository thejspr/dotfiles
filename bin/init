#!/usr/bin/env bash

# Homebrew
ruby -e "$(curl -fsSL https://raw.github.com/mxcl/homebrew/go)"

# Ruby
brew install rbenv ruby-build
eval "$(rbenv init -)"
rbenv install 2.2.0
gem update --system
gem install bundler tmuxinator

# Dotfiles
mkdir -p code
cd code
if [ ! -d 'dotfiles' ]; then
  git clone git@github.com:thejspr/dotfiles.git
fi
cd dotfiles
git pull origin master
rake links

#Prezto
cd ~
zsh
git clone --recursive https://github.com/thejspr/prezto.git "${ZDOTDIR:-$HOME}/.zprezto"
setopt EXTENDED_GLOB
for rcfile in "${ZDOTDIR:-$HOME}"/.zprezto/runcoms/^README.md(.N); do
  ln -s "$rcfile" "${ZDOTDIR:-$HOME}/.${rcfile:t}"
done
chsh -s /usr/local/bin/zsh
echo "source '/Users/jesper/Code/dotfiles/zsh_mods'" >> ~/.zshrc

# Install brew bundles
brew tap Homebrew/brewdler
cd ~/code/dotfiles
brew brewdle

#Launch vim to install plugins
mkdir -p ~/.vim
ln -s ~/code/dotfiles/UltiSnips ~/.vim/UltiSnips
vim -c PlugInstall
